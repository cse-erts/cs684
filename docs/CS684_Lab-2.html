<!DOCTYPE HTML>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>Lab 2 - CS684 Spring 2023</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <base href="">

        <link rel="stylesheet" href="book.css">
        <link href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css">
        <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro:500" rel="stylesheet" type="text/css">

        <link rel="shortcut icon" href="favicon.png">

        <!-- Font Awesome -->
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">

        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme -->
        

        
        <!-- MathJax -->
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
        

        <!-- Fetch Clipboard.js from CDN but have a local fallback -->
        <script src="https://cdn.jsdelivr.net/clipboard.js/1.6.1/clipboard.min.js"></script>
        <script>
            if (typeof Clipboard == 'undefined') {
                document.write(unescape("%3Cscript src='clipboard.min.js'%3E%3C/script%3E"));
            }
        </script>

        <!-- Fetch JQuery from CDN but have a local fallback -->
        <script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
        <script>
            if (typeof jQuery == 'undefined') {
                document.write(unescape("%3Cscript src='jquery.js'%3E%3C/script%3E"));
            }
        </script>

        <!-- Fetch store.js from local - TODO add CDN when 2.x.x is available on cdnjs -->
        <script src="store.js"></script>

    </head>
    <body class="light">
        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme = store.get('mdbook-theme');
            if (theme === null || theme === undefined) { theme = 'light'; }
            $('body').removeClass().addClass(theme);
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var sidebar = store.get('mdbook-sidebar');
            if (sidebar === "hidden") { $("html").addClass("sidebar-hidden") }
            else if (sidebar === "visible") { $("html").addClass("sidebar-visible") }
        </script>

        <div id="sidebar" class="sidebar">
            <ul class="chapter"><li><a href="./Welcome.html"><strong>1.</strong> Welcome</a></li><li><a href="./Resources.html"><strong>2.</strong> Resources</a></li><li><a href="./Installation_instructions.html"><strong>3.</strong> Installation Instructions</a></li><li><a href="./CS684_Labs.html"><strong>4.</strong> Labs</a></li><li><ul class="section"><li><a href="./CS684_Lab-1.html"><strong>4.1.</strong> Lab 1</a></li><li><a href="./CS684_Lab-2.html" class="active"><strong>4.2.</strong> Lab 2</a></li></ul></li><li><a href="./CS684_Assignments.html"><strong>5.</strong> Assignments</a></li><li><ul class="section"><li><a href="./CS684_Assignment-1A.html"><strong>5.1.</strong> Assignment 1A</a></li><li><a href="./CS684_Assignment-1B.html"><strong>5.2.</strong> Assignment 1B</a></li><li><a href="./CS684_Assignment-2.html"><strong>5.3.</strong> Assignment 2</a></li><li><a href="./CS684_Assignment-3.html"><strong>5.4.</strong> Assignment 3</a></li></ul></li></ul>
        </div>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page" tabindex="-1">
                
                <div id="menu-bar" class="menu-bar">
                    <div class="left-buttons">
                        <i id="sidebar-toggle" class="fa fa-bars" title="Toggle sidebar"></i>
                        <i id="theme-toggle" class="fa fa-paint-brush" title="Change theme"></i>
                    </div>

                    <h1 class="menu-title">CS684 Spring 2023</h1>

                    <div class="right-buttons">
                        <a href="print.html">
                            <i id="print-button" class="fa fa-print" title="Print this book"></i>
                        </a>
                    </div>
                </div>

                <div id="content" class="content">
                    <p><center><a class="header" href="./CS684_Lab-2.html#cs684-embedded-system-course" id="cs684-embedded-system-course"><h3>CS684: Embedded System Course</h3></a></center>
<center><a class="header" href="./CS684_Lab-2.html#lab-2-heptagon-code-for-line-following" id="lab-2-heptagon-code-for-line-following"><h4>Lab 2: Heptagon code for Line following</h4></a></center></p>
<hr />
<a class="header" href="./CS684_Lab-2.html#aim" id="aim"><h4>AIM</h4></a>
<ul>
<li>
<p>You have to write a heptagon code for Line Following.</p>
</li>
<li>
<p>Inputs:</p>
<ul>
<li>Values from <strong>5</strong> White Line Sensors.</li>
<li>Each Sensor value ranges between: 0 to 1023.</li>
<li>On white surface, sensor values are low and for black surface, sensor values are high.</li>
</ul>
</li>
<li>
<p>Outputs:</p>
<ul>
<li><strong>3</strong> for controlling the motion of the Robot (1 for Direction and 2 for Motor's velocities).</li>
<li>From the final heptagon node, 3 outputs are required: 2 velocity values (of left and right motors) and direction.
<ul>
<li>Directions list:</li>
</ul>
</li>
</ul>
</li>
</ul>
<table><thead><tr><th align="center"> Direction </th><th align="center"> Representation </th></tr></thead><tbody>
<tr><td align="center">   Stop    </td><td align="center">       0        </td></tr>
<tr><td align="center">  Forward  </td><td align="center">       1        </td></tr>
<tr><td align="center">   Left    </td><td align="center">       2        </td></tr>
<tr><td align="center">   Right   </td><td align="center">       3        </td></tr>
<tr><td align="center"> Backward  </td><td align="center">       4        </td></tr>
</tbody></table>
<ul>
<li>
<p>Motor velocity ranges between 0 to 100. It should not be negative or greater than 100.</p>
</li>
<li>
<p>The heptagon node for line following must be defined according to the format given:</p>
</li>
</ul>
<pre><code>node main(sen0, sen1, sen2, sen3, sen4: int) returns (v_l, v_r, dir: int)
var sen: int^5;
let
     sen = [sen0, sen1, sen2, sen3, sen4];
tel
</code></pre>
<ul>
<li>Using the above information, write a heptagon for Line following of the robot. Consider a black line on white surface.</li>
<li>Use PID controller for line following.</li>
</ul>
<blockquote>
<p>You are free to make assumptions regarding readings of white line sensors at different instances, distance covered by robot for different motions in single step etc.</p>
</blockquote>
<a class="header" href="./CS684_Lab-2.html#algorithm" id="algorithm"><h4>Algorithm</h4></a>
<ul>
<li>White Line following has to be done using the 5 white line sensors provided.</li>
<li>Each sensor value ranges between: 0 to 1023.</li>
<li>On white surface, sensor values are low and for black surface, sensor values are high.</li>
<li>So depending upon the value of the particular sensor, robot has to decide whether it is on the black line or it is deviated from the line.</li>
<li>To adjust the position of the robot if it deviated from the black line, use PID. The same cases as given in Lab 1 (FSM) applies here as well but rather than binary values, now you have to consider values between 0 to 1023.</li>
<li>Likewise, team has to assume different scenarios or test cases which may come across while robot is traversing the arena.</li>
<li>You are free to make assumptions regarding readings of sensors at different instances.</li>
</ul>
<hr />
<a class="header" href="./CS684_Lab-2.html#algorithms-for-line-following" id="algorithms-for-line-following"><h4>Algorithms for Line Following</h4></a>
<a class="header" href="./CS684_Lab-2.html#1-bang-bang-controller" id="1-bang-bang-controller"><h5>1. Bang-bang Controller</h5></a>
<p>Here all the sensor values are converted to binary using thresholding and will be directly used to control the speed and direction of the motors. It uses an if-else ladder structure for logic implementation. The controller that was developed in Lab 1 uses the same logic.
This method is not reliable as numerous cases must be defined for a set of sensor values which will be difficult to implement.</p>
<a class="header" href="./CS684_Lab-2.html#2-pid-controller-with-binary-sensor-values" id="2-pid-controller-with-binary-sensor-values"><h5>2. PID Controller with binary sensor values</h5></a>
<p>PID controller is a feedback loop that utilises the error in the sensor values to correct the position of the robot. Here all the sensor values are converted to binary using thresholding and error value is calculated. This error value is used for controlling the spees and direction of the motor.</p>
<a class="header" href="./CS684_Lab-2.html#3-pid-controller-with-direct-sensor-values" id="3-pid-controller-with-direct-sensor-values"><h5>3. PID Controller with direct sensor values</h5></a>
<p>This is similar to method 2 but here no thresholding is used for sensor values while calculating error. The error calculation can be done using various methods like weighted average or using the sensor values as such.</p>
<hr />
<a class="header" href="./CS684_Lab-2.html#how-does-pid-work" id="how-does-pid-work"><h4>How does PID work?</h4></a>
<p>The system calculates the ‘error’, or ‘deviation’ of the physical quantity from the set point, by measuring the current value of that physical quantity using a sensor(s). To get back to the set point, this ‘error’ should be minimized, and should ideally be made equal to zero. Also, this process should happen as quickly as possible. Ideally, there should be zero lag in the response of the system to the change in its set point.</p>
<p>More information can be found in many books and websites, including here:</p>
<p>http://en.wikipedia.org/wiki/PID_controller</p>
<p>Implementing PID</p>
<p>(i) Error Term (e):</p>
<p>This is equal to the difference between the set point and the current value of the quantity being controlled.</p>
<p>error = set_point – current_value (in our case is the error variable get from the position of Robot over the line</p>
<p>(ii) Proportional Term (P):</p>
<p>This term is proportional to the error.</p>
<p>P = error</p>
<p>This value is responsible for the magnitude of change required in the physical quantity to achieve the set point. The proportion term is what determines the control loop rise time or how quickly it will reach the set point.</p>
<p>(iii) Integral Term (I):</p>
<p>This term is the sum of all the previous error values.</p>
<p>I = I + error</p>
<p>This value is responsible for the quickness of response of the system to the change from the set point. The integral term is used the eliminate the steady state error required by the proportional term. Usually, small Robots doesn't use the integral term because we are not concerned about steady state error and it can complicate the &quot;loop tuning&quot;.</p>
<p>(iv) Differential or Derivative Term (D):</p>
<p>This term is the difference between the instantaneous error from the set point, and the error from the previous instant.</p>
<p>D = error - previousError</p>
<p>This value is responsible to slow down the rate of change of the physical quantity when it comes close to the set point. The derivative term is used to reduce the overshoot or how much the system should &quot;over correct&quot;.</p>
<p>Equation:</p>
<p>PIDvalue = (Kp<em>P) + (Ki</em>I) + (Kd*D)</p>
<p>Where:</p>
<p>Kp is the constant used to vary the magnitude of the change required to achieve the set point.
Ki is the the constant used to vary the rate at which the change should be brought in the physical quantity to achieve the set point.
Kd is the constant used to vary the stability of the system.</p>
<p>Based on the above approach, the bellow function was implemented:</p>
<pre><code>void calculatePID()
{
  P = error;
  I = I + error;
  D = error-previousError;
  PIDvalue = (Kp*P) + (Ki*I) + (Kd*D);
  previousError = error;
}
</code></pre>
<hr />
<a class="header" href="./CS684_Lab-2.html#submission-instructions" id="submission-instructions"><h4>Submission Instructions</h4></a>
<ul>
<li>For Lab-2 submission you have to upload a <strong><code>.tar.gz</code></strong> file.</li>
<li>Folder should contain following:
<ol>
<li><code>.ept</code> file: Heptagon code file</li>
<li><code>Readme.txt</code> file file:
<ul>
<li>Containing information about the assumptions made and description about the conditions or the scenarios if considered, inputs used for simulation and outputs obtained in a tabular form.</li>
<li>Also add youtube link of the video - shoot the screen recording of the simulation of algorithm for atleast 20 steps with different input combinations.</li>
</ul>
</li>
<li><code>Contribution.txt</code> file: stating detailed contribution of each member</li>
</ol>
</li>
<li>Compress the folder and rename it as <code>&lt;GroupName&gt;_Lab_2.tar.gz</code></li>
<li>Upload the file on Moodle</li>
<li>There should be only one submission per group. Member having highest roll no should do the submission.</li>
</ul>

                </div>

                <!-- Mobile navigation buttons -->
                
                    <a rel="prev" href="./CS684_Lab-1.html" class="mobile-nav-chapters previous" title="Previous chapter">
                        <i class="fa fa-angle-left"></i>
                    </a>
                

                
                    <a rel="next" href="./CS684_Assignments.html" class="mobile-nav-chapters next" title="Next chapter">
                        <i class="fa fa-angle-right"></i>
                    </a>
                

            </div>

            
                <a href="./CS684_Lab-1.html" class="nav-chapters previous" title="You can navigate through the chapters using the arrow keys">
                    <i class="fa fa-angle-left"></i>
                </a>
            

            
                <a href="./CS684_Assignments.html" class="nav-chapters next" title="You can navigate through the chapters using the arrow keys">
                    <i class="fa fa-angle-right"></i>
                </a>
            

        </div>


        <!-- Local fallback for Font Awesome -->
        <script>
            if ($(".fa").css("font-family") !== "FontAwesome") {
                $('<link rel="stylesheet" type="text/css" href="_FontAwesome/css/font-awesome.css">').prependTo('head');
            }
        </script>

        <!-- Livereload script (if served using the cli tool) -->
        

        

        

        

        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS script -->
        

    </body>
</html>
